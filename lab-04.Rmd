---
title: "Lab 04 - Visualizing spatial data"
author: "Lilly McClendon"
date: "02-03-2025"
output: github_document
---


### Load packages and data 

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```

### Exercise 1
```{r Denny's-dataset-dimensions}
nrow(dennys)
ncol(dennys)
```

```{r Denny's-dataset-skim}
str(dennys)
```

#### Denny's dataset dimensions

The Denny's dataset dimensions are 1643 x 6, contains 1643 rows with each row representing a Denny's location and 6 columns (address, city, state, zip, longitude, and latitude). The variables are address, city, state, zip, longitude, and latitude. 

### Exercise 2

```{r laquinta-dataset-dimensions}
nrow(laquinta)
ncol(laquinta)
```

```{r laquinta-dataset-skim}
str(laquinta)
```

#### La Quinta dataset dimensions

The La Quinta dataset dimensions are 909 x 6, contains 909 rows with each row representing a La Quinta hotel and 6 columns (address, city, state, zip, longitude, and latitude). The variables are address, city, state, zip, longitude, and latitude. 

### Exercise 3
 
There are La Quinta locations outside of the U.S. in Canada, Mexico, China, New Zealand, Turkey, United Arab Emirates, Chile, Columbia, and Ecuador. On the other hand, there are no Denny's located outside of the U.S.

### Exercise 4

One way I would dertermine whether of not either esatblishment has any locations outside of the U.S. solely using the data would be by the zip code. Zip codes are unique to the U.S. as they are managed by the United States Postal Service. If there is a missing value or NA for zip code, one could make the connection that the location is not located in the U.S. 

### Exercise 5

```{r dennys-outside-US}
dennys %>%
  filter(!(state %in% states$abbreviation))
```

There are not any Denny's locations outside of the U.S. 

### Exercise 6
```{r dennys-add-country-variable}
dennys %>%
  mutate(country = "United States")
```

### Exercise 7

La Quinta has locations Canada, Chile, China, Columbia, Ecuador, Mexico, New Zealand, Turkey, and United Arab Emirates. 

### Exercise 8

```{r laquinta-summarize}
library(dplyr)
laquinta %>%
summarize(state)
```
```{r laquinta-table}
state_counts <- table(laquinta$state)
print(state_counts)
```

```{r filterforint}
library(dplyr)
laquinta_international <- laquinta %>% 
  filter(!state %in% state.abb)
print(laquinta_international)
```

#### La Quinta Locations Update 

There are locations (Cancun, Apodaca, Monterrey, Tegucigalpa) in the dataset that are not posted on the La Quinta website of locations. 

```{r laquinta-locations-outside-us-variable}
laquinta_country <- laquinta %>%
  mutate(country = case_when(
    state %in% state.abb ~ "United States",
    state %in% c("ON", "BC") ~ "Canada",
    state == "ANT" ~ "Colombia",
    state %in% c("AG", "QR", "CH", "NL","VE", "PU", "SL") ~"Mexico", 
    state == "FM" ~ "Honduras"
  )) %>% 
filter(country == "United States")
print(laquinta_country)
```


### Exercise 9

```{r Dennys-state-most-locations}
dennys %>% 
  count(state) %>% 
  arrange(desc(n))
```

```{r laquinta-state-most-locations}
laquinta_country %>% 
  count(state) %>% 
  arrange(desc(n))
```

#### States with most and least Denny's locations 

California has the most (403) Denny's locations and Delaware has the least (1) Denny's locations. I don't find this surprising as California has the greatest population of all the states and has many tourist attractions which leads to more amenities. On the other hand, Delaware has one of the lowest populations, so it seems logical that there would be fewer Denny's locations. 

#### States with most and least La Quinta locations. 

Texas has the most La Quinta locations, which I don't find surprising as Texas has the second highest population in the U.S., and the La Quinta headquarters are in Texas. 

```{r most-dennys-per-thousand-square-miles}
dennys %>%
  count(state) %>%
  inner_join(states, by = c("state" = "abbreviation"))
```

### Exercise 10

```{r dennys-laquinta-single-dataframe}
dn <- dennys %>%
  mutate(establishment = "Denny's")
lq <- laquinta %>%
  mutate(establishment = "La Quinta")
dn_lq <- bind_rows(dn, lq)
```

```{r dennys-laquinta-plot}
ggplot(dn_lq) + 
  geom_point(mapping = aes(x = longitude, y = latitude,
  color = establishment)) + 
  labs(
    title= "Denny's and La Quinta U.S. Locations",
    x = "Longitude", 
    y = "Latitude",
    tag = "Figure 1"
    )
```

### Exercise 11

```{r nc-dennys-laquinta-plot}
ggplot(dn_lq %>% filter(state == "NC")) + 
  geom_point(mapping = aes(x = longitude, y = latitude,
  color = establishment), alpha=.20) + 
  labs(
    title= "North Carolina Denny's and La Quinta Locations",
    x = "Longitude", 
    y = "Latitude",
    tag = "Figure 2"
    )
```

#### Does Mitch Hedberg's joke apply? 

In my opinion, I would agree with Mitch Hedberg that in spanish La Quinta means next to Denny's. When viewing the plot of the locations in North Carolina, almost all but one La Quinta are next to or very near a Denny's.  


### Exercise 12


